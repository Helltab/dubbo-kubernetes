import{d as $,k as E,b as F,u as U,g as G,n as g,r as x,s as J,f,c as s,t as p,e as d,h as r,P as O,o as v,z as m,J as A,I as z,B as h,K as b,F as K,v as L,_ as M}from"./index-xTAF8xFn.js";import{g as Y}from"./service-8CUgewau.js";import{f as j}from"./DateUtil-NptI2C_p.js";import"./request-2XjeWQGZ.js";const q={class:"__container_services_tabs_distribution"},H=["onClick"],Q=["onClick"],W=$({__name:"distribution",setup(X){E(a=>({"70895fcd":r(O)}));const I=F(),C=U(),{appContext:{config:{globalProperties:S}}}=G(),y=g(""),R=x([{label:"不指定",value:""},{label:"version=1.0.0",value:"version=1.0.0"},{label:"group=group1",value:"group=group1"},{label:"version=1.0.0,group=group1",value:"version=1.0.0,group=group1"}]);g(R[0].value);const N=g("provider"),D=[{title:"应用名",dataIndex:"appName",width:"20%",customCell:(a,e)=>{const t=o.value[e].appName;return e===0||o.value[e-1].appName!==t?{rowSpan:o.value.filter(i=>i.appName===t).length}:{rowSpan:0}}},{title:"实例数",dataIndex:"instanceNum",width:"15%",customRender:({record:a})=>{const e=a.appName;return o.value.filter(l=>l.appName===e).length??0},customCell:(a,e)=>{const t=o.value[e].appName;return e===0||o.value[e-1].appName!==t?{rowSpan:o.value.filter(i=>i.appName===t).length}:{rowSpan:0}}},{title:"实例名",dataIndex:"instanceName",width:"25%",ellipsis:!0},{title:"RPC端口",dataIndex:"rpcPort",width:"8%"},{title:"超时时间",dataIndex:"timeOut",width:"10%"},{title:"重试次数",dataIndex:"retryNum",width:"10%"}],o=g([]),n=x({total:0,pageSize:10,current:1,pageOffset:0,showTotal:a=>S.$t("searchDomain.total")+": "+a+" "+S.$t("searchDomain.unit")}),w=async()=>{var l,i,_;let a={serviceName:(l=C.params)==null?void 0:l.pathId,side:N.value,version:((i=C.params)==null?void 0:i.version)||"",group:((_=C.params)==null?void 0:_.group)||"",pageOffset:n.pageOffset,pageSize:n.pageSize};const{data:{list:e,pageInfo:t}}=await Y(a);o.value=e,n.total=t.Total};w();const k=J.debounce(w,300),P=a=>{n.pageSize=a.pageSize||10,n.current=a.current||1,n.pageOffset=(n.current-1)*n.pageSize,k()};return(a,e)=>{const t=d("a-radio-button"),l=d("a-radio-group"),i=d("a-input-search"),_=d("a-flex"),V=d("a-tag"),B=d("a-table");return v(),f("div",q,[s(_,{vertical:""},{default:p(()=>[s(_,{class:"service-filter"},{default:p(()=>[s(l,{value:N.value,"onUpdate:value":e[0]||(e[0]=u=>N.value=u),"button-style":"solid",onClick:r(k)},{default:p(()=>[s(t,{value:"provider"},{default:p(()=>[m("生产者")]),_:1}),s(t,{value:"consumer"},{default:p(()=>[m("消费者")]),_:1})]),_:1},8,["value","onClick"]),s(i,{value:y.value,"onUpdate:value":e[1]||(e[1]=u=>y.value=u),placeholder:"搜索应用，ip，支持前缀搜索",class:"service-filter-input",onSearch:r(k),"enter-button":""},null,8,["value","onSearch"])]),_:1}),s(B,{columns:D,"data-source":o.value,scroll:{y:"45vh"},pagination:n,onChange:P},{bodyCell:p(({column:u,text:c})=>[u.dataIndex==="appName"?(v(),f("span",{key:0,class:"link",onClick:T=>r(I).push("/resources/applications/detail/"+c)},[A("b",null,[s(r(z),{style:{"margin-bottom":"-2px"},icon:"material-symbols:attach-file-rounded"}),m(" "+h(c),1)])],8,H)):b("",!0),u.dataIndex==="instanceName"?(v(),f("span",{key:1,class:"link",onClick:T=>r(I).push("/resources/instances/detail/"+c)},[A("b",null,[s(r(z),{style:{"margin-bottom":"-2px"},icon:"material-symbols:attach-file-rounded"}),m(" "+h(c),1)])],8,Q)):b("",!0),u.dataIndex==="timeOut"?(v(),f(K,{key:2},[m(h(r(j)(c)),1)],64)):b("",!0),u.dataIndex==="label"?(v(),L(V,{key:3,color:r(O)},{default:p(()=>[m(h(c),1)]),_:2},1032,["color"])):b("",!0)]),_:1},8,["data-source","pagination"])]),_:1})])}}}),oe=M(W,[["__scopeId","data-v-549fa778"]]);export{oe as default};
